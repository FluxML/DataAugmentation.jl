<HTML><head><title>Buffering</title><link href=../../template/hugobook.css rel=stylesheet ></link><meta content=Type=text/html; charset=utf-8 http-equiv=Content-Type ></meta></head><body><input onclick=toggleMenu() id=menu-control class=hidden toggle type=checkbox ></input><input id=toc-control type=checkbox class=hidden toggle ></input><main class=container flex ><aside id=menu-container class=book-menu ><nav class=book-menu-content ><h2 id=title >DataAugmentation.jl</h2><div id=sidebar ><div class=doctree ><body><ul><li><p>User guide (TODO)</p><ul><li><p><a href=quickstart.md.html title= >Quickstart</a></p></li></ul></li><li><p>Library</p><ul><li><p><a href=intro.md.html title= >Introduction</a></p></li><li><p><a href=iteminterface.md.html title= >Item interface</a></p></li><li><p><a href=tfminterface.md.html title= >Transformation interface</a></p></li><li><p><a href=buffering.md.html title= >Buffering</a></p></li><li><p>Projective transformations</p><ul><li><p><a href=projective/intro.md.html title= >Introduction</a></p></li><li><p><a href=projective/interface.md.html title= >Interface</a></p></li><li><p><a href=projective/data.md.html title= >Spatial data</a></p></li><li><p><a href=projective/usage.md.html title= >Usage</a></p></li><li><p><a href=projective/gallery.md.html title= >Gallery</a></p></li></ul></li><li><p><a href=preprocessing.md.html title= >Preprocessing</a></p></li></ul></li><li><p><a href=../../REFERENCE.html title= >Reference</a></p></li></ul></body></div></div></nav></aside><div class=book-page ><header class=book-header ></header><article><h1 id=buffering >Buffering</h1><p>As mentioned in the section on <a href=./tfminterface.md.html title= >transformations</a>, you can implement <a href=../../REFERENCE/DataAugmentation.apply!.html ><code>apply!</code></a> as an inplace version of <a href=../../REFERENCE/DataAugmentation.apply.html ><code>apply</code></a> to support buffered transformations. Usually, the result of a regular <code>apply</code> can be used as a buffer. You may write</p><pre lang=julia ><code>buffer = apply(tfm, item)
apply!(buffer, tfm, item)
</code></pre><p>However, for some transformations, a different buffer is needed. <a href=../../REFERENCE/DataAugmentation.Sequence.html ><code>Sequence</code></a>, for example, needs to reuse all intermediate results. That is why the buffer creation can be customized:</p><ul><li><p><a href=../../REFERENCE/DataAugmentation.makebuffer.html ><code>DataAugmentation.makebuffer</code></a><code>(tfm, item)</code> creates a buffer <code>buf</code> that can be used in an <code>apply!</code> call: <code>apply!(buf, tfm, item)</code>.</p></li></ul><hr></hr><p>Managing the buffers manually quickly becomes tedious. For convenience, this library implements <a href=../../REFERENCE/DataAugmentation.Buffered.html ><code>Buffered</code></a>, a transformation wrapper that will use a buffer internally. <code>btfm = Buffered(tfm)</code> will create a buffer the first time it is <code>apply</code>ed and then use it by internally calling <code>apply!</code>.</p><pre lang=julia ><code>buffered = Buffered(tfm)
buffer = apply(tfm, item)  # uses apply! internally
</code></pre><p>Since <code>Buffered</code> only stores one buffer, you may run into problems when using it in a multi-threading context where different threads invalidate the buffer before it can be used. In that case, you can use <a href=../../REFERENCE/DataAugmentation.BufferedThreadsafe.html ><code>BufferedThreadsafe</code></a>, a version of <code>Buffered</code> that keeps a separate buffer for every thread.</p></article><footer class=book-footer ></footer></div><aside class=book-toc ><nav id=toc class=book-toc-content ><ul><li><a href=#buffering >Buffering</a><ul></ul></li></ul></nav></aside></main></body></HTML>