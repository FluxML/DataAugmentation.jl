<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gallery · DataAugmentation.jl</title><meta name="title" content="Gallery · DataAugmentation.jl"/><meta property="og:title" content="Gallery · DataAugmentation.jl"/><meta property="twitter:title" content="Gallery · DataAugmentation.jl"/><meta name="description" content="Documentation for DataAugmentation.jl."/><meta property="og:description" content="Documentation for DataAugmentation.jl."/><meta property="twitter:description" content="Documentation for DataAugmentation.jl."/><meta property="og:url" content="https://fluxml.ai/DataAugmentation.jl/stable/projective/gallery/"/><meta property="twitter:url" content="https://fluxml.ai/DataAugmentation.jl/stable/projective/gallery/"/><link rel="canonical" href="https://fluxml.ai/DataAugmentation.jl/stable/projective/gallery/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/flux.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DataAugmentation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">DataAugmentation.jl</a></li><li><a class="tocitem" href="../../quickstart/">Quickstart</a></li><li><a class="tocitem" href="../../transformations/">Transformations</a></li><li><span class="tocitem">Build your transformations</span><ul><li><a class="tocitem" href="../../iteminterface/">Item Interface</a></li><li><a class="tocitem" href="../../tfminterface/">Transform Interface</a></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox" checked/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Projective Interface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro/">Intro</a></li><li><a class="tocitem" href="../data/">Data</a></li><li class="is-active"><a class="tocitem" href>Gallery</a><ul class="internal"><li><a class="tocitem" href="#[RandomResizeCrop](@ref)(sz)"><span><code>RandomResizeCrop</code><code>(sz)</code></span></a></li><li><a class="tocitem" href="#[CenterResizeCrop](@ref)"><span><code>CenterResizeCrop</code></span></a></li><li><a class="tocitem" href="#[Crop](@ref)(sz[,-from])"><span><code>Crop</code><code>(sz[, from])</code></span></a></li><li><a class="tocitem" href="#[FlipX](@ref),-[FlipY](@ref),-[Reflect](@ref)"><span><code>FlipX</code>, <code>FlipY</code>, <code>Reflect</code></span></a></li><li><a class="tocitem" href="#[Rotate](@ref),-[RotateX](@ref),-[RotateY](@ref),-[RotateZ](@ref)"><span><code>Rotate</code>, <code>RotateX</code>, <code>RotateY</code>, <code>RotateZ</code></span></a></li></ul></li></ul></li></ul></li><li><span class="tocitem">Misc</span><ul><li><a class="tocitem" href="../../buffering/">Buffering</a></li><li><a class="tocitem" href="../../preprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../../ref/">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Build your transformations</a></li><li><a class="is-disabled">Projective Interface</a></li><li class="is-active"><a href>Gallery</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gallery</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FluxML/DataAugmentation.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FluxML/DataAugmentation.jl/blob/master/docs/src/projective/gallery.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Gallery"><a class="docs-heading-anchor" href="#Gallery">Gallery</a><a id="Gallery-1"></a><a class="docs-heading-anchor-permalink" href="#Gallery" title="Permalink"></a></h1><p>Let&#39;s visualize what these projective transformations look like.</p><p>You can apply them to <a href="../../ref/#DataAugmentation.Image"><code>Image</code></a>s and the keypoint-based items <a href="../../ref/#DataAugmentation.Keypoints"><code>Keypoints</code></a>, <a href="../../ref/#DataAugmentation.Polygon"><code>Polygon</code></a>, and <a href="../../ref/#DataAugmentation.BoundingBox"><code>BoundingBox</code></a>.</p><p>Let&#39;s take this picture of a light house:</p><pre><code class="language-julia hljs">using DataAugmentation
using MosaicViews
using Images
using TestImages
using StaticArrays

imagedata = testimage(&quot;lighthouse&quot;)
imagedata = imresize(imagedata, ratio = 196 / size(imagedata, 1))</code></pre><img src="31e80491.png" alt="Example block output"/><p>To apply a transformation <code>tfm</code> to it, wrap it in <code>Image</code>, apply the transformation and unwrap it using <a href="../../ref/#DataAugmentation.itemdata"><code>itemdata</code></a>:</p><pre><code class="language-julia hljs">tfm = CenterCrop((196, 196))
image = Image(imagedata)
apply(tfm, image) |&gt; itemdata</code></pre><img src="6e8a1845.png" alt="Example block output"/><p>Customization of how pixel values are interpolated and extrapolated during transformations is done with the Item types (<a href="../../ref/#DataAugmentation.Image"><code>Image</code></a>, <a href="../../ref/#DataAugmentation.MaskBinary"><code>MaskBinary</code></a>, <a href="../../ref/#DataAugmentation.MaskMulti"><code>MaskMulti</code></a>). For example, if we scale the image we can see how the interpolation affects how values of projected pixels are calculated.</p><pre><code class="language- hljs">using Interpolations: BSpline, Constant, Linear
tfm = ScaleFixed((2000, 2000)) |&gt; CenterCrop((200, 200))
showgrid(
    [
        # Default is linear interpolation for Image
        apply(tfm, Image(imagedata)),
        # Nearest neighbor interpolation
        apply(tfm, Image(imagedata; interpolate=BSpline(Constant()))),
        # Linear interpolation
        apply(tfm, Image(imagedata; interpolate=BSpline(Linear()))),
    ];
    ncol=3,
    npad=8,
)</code></pre><p>Similarly, if we crop to a larger region than the image, we can see how extrapolation affects how pixel values are calculated in the regions outside the original image bounds.</p><pre><code class="language- hljs">import Interpolations
tfm = CenterCrop((400, 400))
showgrid(
    [
        apply(tfm, Image(imagedata)),
        apply(tfm, Image(imagedata; extrapolate=1)),
        apply(tfm, Image(imagedata; extrapolate=Interpolations.Flat())),
        apply(tfm, Image(imagedata; extrapolate=Interpolations.Periodic())),
        apply(tfm, Image(imagedata; extrapolate=Interpolations.Reflect())),
    ];
    ncol=5,
    npad=8,
)</code></pre><p>Now let&#39;s say we want to train a light house detector and have a bounding box for the light house. We can use the <a href="../../ref/#DataAugmentation.BoundingBox"><code>BoundingBox</code></a> item to represent it. It takes the two corners of the bounding rectangle as the first argument. As the second argument we have to pass the size of the corresponding image.</p><pre><code class="language-julia hljs">points = SVector{2, Float32}[SVector(23., 120.), SVector(120., 150.)]
bbox = BoundingBox(points, size(imagedata))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BoundingBox{2, Float32}()</code></pre><p><a href="../../ref/#DataAugmentation.showitems"><code>showitems</code></a> visualizes the two items:</p><pre><code class="language-julia hljs">showitems((image, bbox))</code></pre><img src="c79ce83d.png" alt="Example block output"/><p>If we apply transformations like translation and cropping to the image, then the same transformations have to be applied to the bounding box. Otherwise, the bounding box will no longer match up with the light house.</p><p>Another problem can occur with stochastic transformations like <a href="../../ref/#DataAugmentation.RandomResizeCrop"><code>RandomResizeCrop</code></a> If we apply it separately to the image and the bounding box, they will be cropped from slightly different locations:</p><pre><code class="language-julia hljs">tfm = RandomResizeCrop((128, 128))
showitems((
    apply(tfm, image),
    apply(tfm, bbox)
))</code></pre><img src="b76de68e.png" alt="Example block output"/><p>Instead, pass a tuple of the items to a single <code>apply</code> call so the same random state will be used for both image and bounding box:</p><pre><code class="language-julia hljs">apply(tfm, (image, bbox)) |&gt; showitems</code></pre><img src="83c87b9b.png" alt="Example block output"/><div class="admonition is-info"><header class="admonition-header">3D Projective dimensions</header><div class="admonition-body"><p>We&#39;ll use a 2-dimensional <a href="../../ref/#DataAugmentation.Image"><code>Image</code></a> and <a href="../../ref/#DataAugmentation.BoundingBox"><code>BoundingBox</code></a> here, but you can apply most projective transformations to any spatial item (including <a href="../../ref/#DataAugmentation.Keypoints"><code>Keypoints</code></a>, <a href="../../ref/#DataAugmentation.MaskBinary"><code>MaskBinary</code></a> and <a href="../../ref/#DataAugmentation.MaskMulti"><code>MaskMulti</code></a>) in 3 dimensions.</p><p>Of course, you have to create a 3-dimensional transformation, i.e. <code>CenterCrop((128, 128, 128))</code> instead of <code>CenterCrop((128, 128))</code>.</p></div></div><h2 id="[RandomResizeCrop](@ref)(sz)"><a class="docs-heading-anchor" href="#[RandomResizeCrop](@ref)(sz)"><a href="../../ref/#DataAugmentation.RandomResizeCrop"><code>RandomResizeCrop</code></a><code>(sz)</code></a><a id="[RandomResizeCrop](@ref)(sz)-1"></a><a class="docs-heading-anchor-permalink" href="#[RandomResizeCrop](@ref)(sz)" title="Permalink"></a></h2><p>Resizes the sides so that one of them is no longer than <code>sz</code> and crops a region of size <code>sz</code> <em>from a random location</em>.</p><pre><code class="language-julia hljs">tfm = RandomResizeCrop((128, 128))
showgrid([apply(tfm, (image, bbox)) for _ in 1:6]; ncol=6, npad=8)</code></pre><img src="595d7072.png" alt="Example block output"/><h2 id="[CenterResizeCrop](@ref)"><a class="docs-heading-anchor" href="#[CenterResizeCrop](@ref)"><a href="../../ref/#DataAugmentation.CenterResizeCrop"><code>CenterResizeCrop</code></a></a><a id="[CenterResizeCrop](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[CenterResizeCrop](@ref)" title="Permalink"></a></h2><p>Resizes the sides so that one of them is no longer than <code>sz</code> and crops a region of size <code>sz</code> <em>from the center</em>.</p><pre><code class="language-julia hljs">tfm = CenterResizeCrop((128, 128))
showgrid([apply(tfm, (image, bbox))]; ncol=6, npad=8)</code></pre><img src="7792ebdc.png" alt="Example block output"/><h2 id="[Crop](@ref)(sz[,-from])"><a class="docs-heading-anchor" href="#[Crop](@ref)(sz[,-from])"><a href="../../ref/#DataAugmentation.Crop"><code>Crop</code></a><code>(sz[, from])</code></a><a id="[Crop](@ref)(sz[,-from])-1"></a><a class="docs-heading-anchor-permalink" href="#[Crop](@ref)(sz[,-from])" title="Permalink"></a></h2><p>Crops a region of size <code>sz</code> from the image, <em>without resizing</em> the image first.</p><pre><code class="language-julia hljs">using DataAugmentation: FromOrigin, FromCenter, FromRandom
tfms = [
    Crop((128, 128), FromOrigin()),
    Crop((128, 128), FromCenter()),
    Crop((128, 128), FromRandom()),
    Crop((128, 128), FromRandom()),
    Crop((128, 128), FromRandom()),
    Crop((128, 128), FromRandom()),
]
showgrid([apply(tfm, (image, bbox)) for tfm in tfms]; ncol=6, npad=8)</code></pre><img src="5814aa80.png" alt="Example block output"/><h2 id="[FlipX](@ref),-[FlipY](@ref),-[Reflect](@ref)"><a class="docs-heading-anchor" href="#[FlipX](@ref),-[FlipY](@ref),-[Reflect](@ref)"><a href="../../ref/#DataAugmentation.FlipX"><code>FlipX</code></a>, <a href="../../ref/#DataAugmentation.FlipY"><code>FlipY</code></a>, <a href="../../ref/#DataAugmentation.Reflect"><code>Reflect</code></a></a><a id="[FlipX](@ref),-[FlipY](@ref),-[Reflect](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[FlipX](@ref),-[FlipY](@ref),-[Reflect](@ref)" title="Permalink"></a></h2><p>Flip the data on the horizontally and vertically, respectively. More generally, reflect around an angle from the x-axis.</p><pre><code class="language-julia hljs">tfms = [
    FlipX(),
    FlipY(),
    Reflect(30),
]
showgrid([apply(tfm, (image, bbox)) for tfm in tfms]; ncol=6, npad=8)</code></pre><img src="4b1cd8cf.png" alt="Example block output"/><h2 id="[Rotate](@ref),-[RotateX](@ref),-[RotateY](@ref),-[RotateZ](@ref)"><a class="docs-heading-anchor" href="#[Rotate](@ref),-[RotateX](@ref),-[RotateY](@ref),-[RotateZ](@ref)"><a href="../../ref/#DataAugmentation.Rotate"><code>Rotate</code></a>, <a href="../../ref/#DataAugmentation.RotateX"><code>RotateX</code></a>, <a href="../../ref/#DataAugmentation.RotateY"><code>RotateY</code></a>, <a href="../../ref/#DataAugmentation.RotateZ"><code>RotateZ</code></a></a><a id="[Rotate](@ref),-[RotateX](@ref),-[RotateY](@ref),-[RotateZ](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[Rotate](@ref),-[RotateX](@ref),-[RotateY](@ref),-[RotateZ](@ref)" title="Permalink"></a></h2><p>Rotate a 2D image counter-clockwise by an angle.</p><pre><code class="language-julia hljs">tfm = Rotate(20) |&gt; CenterCrop((256, 256))
showgrid([apply(tfm, (image, bbox)) for _ in 1:6]; ncol=6, npad=8)</code></pre><img src="5a64ecbd.png" alt="Example block output"/><p>Rotate also works with 3D images in addition to 3D specific transforms RotateX, RotateY, and RotateZ.</p><pre><code class="language-julia hljs">image3D = Image([RGB(i, j, k) for i=0:0.01:1, j=0:0.01:1, k=0:0.01:1])
tfms = [
    Rotate(20, 30, 40),
    Rotate{3}(45),
    RotateX(45),
    RotateY(45),
    RotateZ(45),
]
transformed = [apply(tfm, image3D) |&gt; itemdata for tfm in tfms]
slices = [Image(parent(t[:, :, 50])) for t in transformed]
showgrid(slices; ncol=6, npad=8)</code></pre><img src="69cbed0e.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../data/">« Data</a><a class="docs-footer-nextpage" href="../../buffering/">Buffering »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 22 September 2024 05:46">Sunday 22 September 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
